<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=author content="less "><meta name=description content="Yesterday I was playing with linpeas and found a privilege escalation path on my system.
My user was automatically added to the docker group during the installation of docker. That means that my user has write access to docker.sock and can mount the local file system on a container to gain root access.
Running this command is all it takes to become root: docker -H unix:///var/run/docker.sock run -v /:/host -it image chroot /host /bin/bash"><meta name=keywords content="cybersecurity,physical security,physec,personal blog"><meta property="og:image" content><meta name=robots content="noodp"><meta name=theme-color content><link rel=canonical href=https://lessonsec.com/thoughts/docker_privesc/><title>Docker_privesc - less on sec</title><link href=https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css rel=stylesheet type=text/css><link rel=stylesheet href=https://lessonsec.com/main.d90ac829698801facfc94a2c6697ffd5351a884747e47e797814944b5cbef4f5.css><link rel=apple-touch-icon sizes=180x180 href=https://lessonsec.com/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://lessonsec.com/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://lessonsec.com/favicon-16x16.png><link rel=manifest href=https://lessonsec.com/site.webmanifest><link rel=mask-icon href=https://lessonsec.com/safari-pinned-tab.svg color=#1b1c1d><link rel="shortcut icon" href=https://lessonsec.com/favicon.ico><meta name=msapplication-TileColor content="#1b1c1d"><meta name=theme-color content="#1b1c1d"><meta itemprop=name content="Docker_privesc"><meta itemprop=description content="Yesterday I was playing with linpeas and found a privilege escalation path on my system.
My user was automatically added to the docker group during the installation of docker. That means that my user has write access to docker.sock and can mount the local file system on a container to gain root access.
Running this command is all it takes to become root: docker -H unix:///var/run/docker.sock run -v /:/host -it image chroot /host /bin/bash"><meta itemprop=datePublished content="2021-05-05T10:06:52+02:00"><meta itemprop=dateModified content="2021-05-05T10:06:52+02:00"><meta itemprop=wordCount content="90"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="Docker_privesc"><meta name=twitter:description content="Yesterday I was playing with linpeas and found a privilege escalation path on my system.
My user was automatically added to the docker group during the installation of docker. That means that my user has write access to docker.sock and can mount the local file system on a container to gain root access.
Running this command is all it takes to become root: docker -H unix:///var/run/docker.sock run -v /:/host -it image chroot /host /bin/bash"><meta property="og:title" content="Docker_privesc"><meta property="og:description" content="Yesterday I was playing with linpeas and found a privilege escalation path on my system.
My user was automatically added to the docker group during the installation of docker. That means that my user has write access to docker.sock and can mount the local file system on a container to gain root access.
Running this command is all it takes to become root: docker -H unix:///var/run/docker.sock run -v /:/host -it image chroot /host /bin/bash"><meta property="og:type" content="article"><meta property="og:url" content="https://lessonsec.com/thoughts/docker_privesc/"><meta property="article:section" content="thoughts"><meta property="article:published_time" content="2021-05-05T10:06:52+02:00"><meta property="article:modified_time" content="2021-05-05T10:06:52+02:00"><meta property="article:published_time" content="2021-05-05 10:06:52 +0200 CEST"></head><body><div class=container><link rel=apple-touch-icon sizes=60x60 href=https://lessonsec.com/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://lessonsec.com/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://lessonsec.com/favicon-16x16.png><link rel=manifest href=https://lessonsec.com/site.webmanifest><link rel=mask-icon href=https://lessonsec.com/safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#da532c"><meta name=theme-color content="#ffffff"><header class=header><span class=header__inner><a href=https://lessonsec.com/ style=text-decoration:none><div class=logo><span class=logo__mark></span><span class=logo__text>less@machine:~$</span>
<span class=logo__cursor style=background-color:#a9a9b3;animation-duration:2s></span></div></a><span class=header__right><nav class=menu><ul class=menu__inner><li><a href=https://lessonsec.com/whoami/>Whoami</a></li><li><a href=https://lessonsec.com/posts/>Posts</a></li><li><a href=https://lessonsec.com/thoughts/>Thoughts</a></li></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span></span></span></header><div class=content><main class=post><div class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>One minute</p></div><article><h1 class=post-title><a href=https://lessonsec.com/thoughts/docker_privesc/>Docker_privesc</a></h1><div class=post-content><p>Yesterday I was playing with <a href=https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS>linpeas</a> and found a privilege escalation path on my system.</p><p>My user was automatically added to the <code>docker</code> group during the installation of docker. That means that my user has write access to <code>docker.sock</code> and can mount the local file system on a container to gain root access.</p><p>Running this command is all it takes to become root: <code>docker -H unix:///var/run/docker.sock run -v /:/host -it image chroot /host /bin/bash</code></p><p>A possible remediation could be to create a dedicated user to use docker.</p><p>More here: <a href=https://book.hacktricks.xyz/linux-unix/privilege-escalation#writable-docker-socket>https://book.hacktricks.xyz/linux-unix/privilege-escalation#writable-docker-socket</a></p></div></article><hr><div class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>90 Words</p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg></p></div></main></div><footer class=footer><div class=footer__inner><div class=footer__content><span>&copy; 2021</span>
<span><a href=https://lessonsec.com/>less</a></span>
<span><a href=https://lessonsec.com/posts/index.xml target=_blank title=rss><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></span></div></div></footer></div><script type=text/javascript src=https://lessonsec.com/bundle.min.2ce64ea6ea44a72b13dd812fc2eb5cca3efe878cce258a47c137c17edf46e0602a05e422b618a5b80b5939c731b7a293351c2f2222a21f6ee27e54a8448dd20e.js integrity="sha512-LOZOpupEpysT3YEvwutcyj7+h4zOJYpHwTfBft9G4GAqBeQithiluAtZOccxt6KTNRwvIiKiH27iflSoRI3SDg=="></script><script data-goatcounter=https://lessonsec.goatcounter.com/count async src=//lessonsec.com/script/count.js></script></body></html>